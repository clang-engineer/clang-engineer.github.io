---
title       : direnv 사용법 정리
description : 
date        : 2026-02-21 10:12:00 +0900
updated     : 2026-02-21 10:32:00 +0900
categories  : [dev, shell]
tags        : [direnv, shell, env]
pin         : false
hidden      : false
---

# direnv 사용법 정리

프로젝트 디렉토리에 들어가면 환경변수를 자동으로 로드하고, 나가면 해제해주는 도구가 `direnv` 입니다.
언어/프레임워크와 상관없이 “프로젝트 단위 환경”을 관리할 때 유용합니다.

---

## 0. 환경변수를 쓸 일이 많을까?

의외로 자주 쓰입니다. 아래 항목 중 하나라도 해당되면 환경변수를 꾸준히 쓰게 됩니다.

- 로컬/스테이징/프로덕션 설정 분리
- API 키, 토큰, DB 접속 정보 같은 민감 값 관리
- 프로젝트별 포트, 로그 레벨, 피처 플래그
- 프로젝트마다 다른 런타임/툴체인 옵션

`direnv`는 이런 설정을 **디렉토리 기준으로 자동 적용**해주기 때문에, 전역 환경변수를 건드리지 않고도 안전하게 관리할 수 있습니다.

---

## 1. 설치

### macOS (Homebrew)

```sh
brew install direnv
```

### Ubuntu / Debian

```sh
sudo apt-get update
sudo apt-get install direnv
```

### Fedora

```sh
sudo dnf install direnv
```

### Arch

```sh
sudo pacman -S direnv
```

---

## 2. 쉘에 hook 추가

`direnv`는 쉘이 디렉토리를 이동할 때 동작합니다.
사용하는 쉘의 설정 파일에 hook을 추가합니다.

### zsh

```sh
echo 'eval "$(direnv hook zsh)"' >> ~/.zshrc
```

### bash

```sh
echo 'eval "$(direnv hook bash)"' >> ~/.bashrc
```

### fish

```sh
echo 'direnv hook fish | source' >> ~/.config/fish/config.fish
```

설정 후 쉘을 재시작하거나 `source ~/.zshrc` 등을 실행합니다.

---

## 3. 기본 사용법

### 1) .envrc 생성

프로젝트 루트에 `.envrc` 파일을 만들고 환경변수를 정의합니다.

```sh
export APP_ENV=local
export API_URL=http://localhost:8080
export PATH="$PWD/bin:$PATH"
```

### 2) 허용(allow)

보안상, `.envrc`는 **명시적으로 허용**해야 적용됩니다.

```sh
direnv allow
```

이후 해당 디렉토리에 들어갈 때 자동으로 환경변수가 로드됩니다.

### 3) 변경 시 재허용

`.envrc`를 수정하면 다시 허용해야 합니다.

```sh
direnv allow
```

---

## 4. 자주 쓰는 패턴

### 언어별 버전 관리 도구와 함께 쓰기

```sh
export JAVA_HOME="/usr/lib/jvm/temurin-17"
export PATH="$JAVA_HOME/bin:$PATH"
```

### 로컬 전용 설정 분리

`.envrc`에 민감한 값을 직접 넣기보다, 로컬 파일로 분리해 불러옵니다.

`.envrc`:

```sh
dotenv .env
dotenv_if_exists .env.local
```

`.gitignore`:

```gitignore
.env
.env.local
.envrc.local
```

별도 파일을 직접 소스하려면 아래처럼 사용할 수 있습니다.

```sh
source_env_if_exists .envrc.local
```

---

## 5. direnv stdlib: layout 활용

`direnv`는 자주 쓰는 프로젝트 구성에 맞춘 `layout` 기능을 제공합니다.
필요한 PATH/환경변수를 자동으로 구성해줍니다.

### Node

```sh
layout node
```

`$PWD/node_modules/.bin` 이 PATH에 추가됩니다.

### Python

```sh
layout python python3
```

`.direnv` 아래에 venv를 만들고 로드합니다.

### Go

```sh
layout go
```

`GOPATH`와 `PATH`가 프로젝트 기준으로 설정됩니다.

### PHP

```sh
layout php
```

`$PWD/vendor/bin` 이 PATH에 추가됩니다.

---

## 6. 보안/주의사항

- `direnv allow`는 **해당 디렉토리의 `.envrc`를 신뢰한다는 뜻**입니다.
- 저장소를 클론한 직후에는 내용을 확인하고 허용합니다.
- `.envrc`에 토큰/패스워드를 직접 넣기보다 별도 파일로 분리하는 것이 안전합니다.

---

## 7. Windows에서는?

Windows 네이티브 환경에서는 일반적으로 사용하지 않습니다.
대신 **WSL 환경**에서 Linux 셸과 함께 사용하는 경우가 많습니다.

---

## 8. 트러블슈팅

### 변경한 `.envrc`가 반영되지 않을 때

```sh
direnv allow
```

### 적용 상태 확인

```sh
direnv status
```

---

## 참고

- https://direnv.net/
- https://github.com/direnv/direnv
