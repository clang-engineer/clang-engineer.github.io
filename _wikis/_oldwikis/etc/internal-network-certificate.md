---
layout  : wiki
title   : 내부망에서 인터넷 사용시 인증서의 식별
summary : 
date    : 2023-06-08 14:41:35 +0900
updated : 2023-06-09 15:50:47 +0900
tags    : 
toc     : true
public  : true
parent  : [[etc/index]]
latex   : false
---
* TOC
{:toc}


# 이슈

타회사 망에서 외부 인터넷을 사용하려 할 때 브라우저 or 외부모듈 다운로드가 안되는 현상이 있었다.  인증서 관련 오류 메시지가 공통적으로 나타났기 때문에, 브라우저에서 인식되는 인증서를 확인해보았다. 실제 타겟 주소들의 공인 인증서가 아닌 사설 인증서의 형태였다.


# 원인

해당 현상의 원인은 여러가지 있을 수 있는데 찾아본 바로는 아래의 세가지 사유로 인해 보통 나타난다고 한다. 

1. 중간 인증 기관 (Intermediate Certificate Authority) 사용: 대부분의 웹사이트 인증서는 중간 인증 기관을 통해 발급됩니다. 회사의 내부망에서는 내부 인증서를 사용하거나 중간 인증 기관을 사용할 수 있습니다. 따라서 내부망에서 접근하는 외부 웹사이트의 인증서는 중간 인증 기관에 의해 발급되어 기관의 루트 인증서와 연결될 수 있습니다. 이 경우, 타겟 주소의 인증서와는 상이한 중간 인증 기관의 인증서를 볼 수 있습니다.

2. 프록시 서버 사용: 회사 내부망에서는 프록시 서버를 사용하여 인터넷 연결을 관리할 수 있습니다. 이 경우, 프록시 서버의 인증서가 브라우저에 표시됩니다. 프록시 서버가 중간 인증 기관에 의해 발급된 인증서를 사용하거나 자체 서명된 인증서를 사용할 수 있습니다.

3. SSL 인스pection: 일부 기업 환경에서는 보안 목적으로 SSL 인스pection이라는 기술을 사용하여 내부 네트워크에서 전송되는 암호화된 데이터를 검사할 수 있습니다. 이 경우, 회사의 보안 장비에서 내부 인증서를 생성하고 원래의 인증서를 대신하는 인증서를 사용합니다. 이로 인해 브라우저에는 원래 사이트의 인증서와 다른 인증서가 표시됩니다.


# 해결

1. 내부망 관리자에게 인증서 설치 프로그램을 전달받자. 
   
2. 1.의 방식이 어려운 상황인 경우?
    1. 브라우저에서 인증서 보기를 통해 직접 인증서 다운로드.
	2. mac의 경우
	- keychain access >> 인증서를 drag & drop

	2. java의 경우 (gradle, maven)
	- 인증서 등록
	keytool -import -trustcacerts -keystore \<사용중인 java설치 경로\>/Contents/Home/lib/security/cacerts -storepass \<인증서 패스워드\> -alias ewalker_ssl -file \<인증서 파일 경로\>
	- 등록된 인증서 확인 
	keytool -list -keystore \<사용중인 java설치 경로\>/Contents/Home/lib/security/cacerts -storepass \<인증서 패스워드\>
	
	
	
